{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="auth-split-container">
    <!-- Left Side - Geometric Shapes -->
    <div class="auth-left-panel">
        <div class="shapes-illustration">
            <!-- Orange Semi-Circle -->
            <div class="shape-semicircle">
                <div class="shape-face">
                    <div class="shape-eye left-eye">
                        <div class="pupil"></div>
                    </div>
                    <div class="shape-eye right-eye">
                        <div class="pupil"></div>
                    </div>
                    <div class="shape-mouth happy"></div>
                </div>
            </div>
            
            <!-- Purple Rectangle -->
            <div class="shape-rect-purple">
                <div class="shape-face">
                    <div class="shape-eye left-eye">
                        <div class="pupil"></div>
                    </div>
                    <div class="shape-eye right-eye">
                        <div class="pupil"></div>
                    </div>
                </div>
            </div>
            
            <!-- Dark Rectangle -->
            <div class="shape-rect-dark">
                <div class="shape-face">
                    <div class="shape-eye left-eye">
                        <div class="pupil"></div>
                    </div>
                    <div class="shape-eye right-eye">
                        <div class="pupil"></div>
                    </div>
                </div>
            </div>
            
            <!-- Yellow Pill -->
            <div class="shape-pill-yellow">
                <div class="shape-face">
                    <div class="shape-eye left-eye">
                        <div class="pupil"></div>
                    </div>
                    <div class="shape-mouth line"></div>
                </div>
            </div>
        </div>
        
        <!-- Brand Name -->
        <div class="brand-name">Edumi</div>
    </div>
    
    <!-- Right Side - Login Form -->
    <div class="auth-right-panel">
        <div class="auth-form-container">
            <div class="auth-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
            </div>
            
            <h1>Welcome back!</h1>
            <p class="auth-subtitle">Please enter your details</p>
            
            <form method="post" class="auth-form">
                {% csrf_token %}
                
                <div class="form-field">
                    <label>Email</label>
                    <input type="text" name="username" required placeholder="Enter your email" autofocus>
                </div>
                
                <div class="form-field">
                    <label>Password</label>
                    <div class="password-field">
                        <input type="password" name="password" required placeholder="Enter your password" id="passwordInput">
                        <button type="button" class="toggle-password" onclick="togglePassword()">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="form-options">
                    <label class="checkbox-label">
                        <input type="checkbox" name="remember">
                        <span>Remember for 30 days</span>
                    </label>
                    <a href="#" class="forgot-link">Forgot password?</a>
                </div>
                
                {% if error %}
                    <div class="error-alert">{{ error }}</div>
                {% endif %}
                
                <button type="submit" class="btn-login">Log in</button>
            </form>
            
            <p class="signup-link">
                Don't have an account? <a href="{% url 'register' %}">Sign up</a>
            </p>
        </div>
    </div>
</div>

<script>
// Eyes follow cursor with constrained pupil movement
document.addEventListener('DOMContentLoaded', function() {
    const container = document.querySelector('.auth-split-container');
    const pupils = document.querySelectorAll('.pupil');
    const eyes = document.querySelectorAll('.shape-eye');
    const passwordInput = document.getElementById('passwordInput');
    let isLookingAway = false;
    
    // Eye following cursor
    container.addEventListener('mousemove', function(e) {
        if (isLookingAway) return; // Don't follow cursor when looking away
        
        pupils.forEach(pupil => {
            const eye = pupil.parentElement;
            const eyeRect = eye.getBoundingClientRect();
            const eyeCenterX = eyeRect.left + eyeRect.width / 2;
            const eyeCenterY = eyeRect.top + eyeRect.height / 2;
            
            // Calculate angle to cursor
            const angle = Math.atan2(e.clientY - eyeCenterY, e.clientX - eyeCenterX);
            
            // Maximum distance pupil can move
            const maxDistance = 2;
            
            const pupilX = Math.cos(angle) * maxDistance;
            const pupilY = Math.sin(angle) * maxDistance;
            
            // Apply transform from center position
            pupil.style.transform = `translate(calc(-50% + ${pupilX}px), calc(-50% + ${pupilY}px))`;
        });
    });
    
    // Look away when typing password
    if (passwordInput) {
        passwordInput.addEventListener('focus', function() {
            isLookingAway = true;
            eyes.forEach(eye => eye.classList.add('looking-away'));
        });
        
        passwordInput.addEventListener('blur', function() {
            isLookingAway = false;
            eyes.forEach(eye => eye.classList.remove('looking-away'));
        });
    }
});

// Toggle password visibility
function togglePassword() {
    const input = document.getElementById('passwordInput');
    const eyes = document.querySelectorAll('.shape-eye');
    
    if (input.type === 'password') {
        input.type = 'text';
        // Look back when password is visible
        eyes.forEach(eye => eye.classList.remove('looking-away'));
    } else {
        input.type = 'password';
        // Look away when password is hidden and focused
        if (document.activeElement === input) {
            eyes.forEach(eye => eye.classList.add('looking-away'));
        }
    }
}
</script>
{% endblock %}
